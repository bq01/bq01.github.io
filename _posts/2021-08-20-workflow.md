---
layout: post
title: 青峰社區硬體改善工作排程
subtitle: 
cover-img: /assets/img/content-header.png
share-img: 
thumbnail-img:
tags: [工作排程]
---

青峰社區硬體改善工作排程，會納入住戶們關心的議題，並隨時更新進度。

<div id="googlSheet">Googl Sheets 讀取中...</div>

<script>
    let request = new XMLHttpRequest();

    function callGoogleSheet() {
        if(request) {
            request.open('GET', 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTDROQFkO23mIAG1wvbzCoXHKsIAwXT3ognEMeEr6QFOR076eg3WThpqO1g7Lk1OGRMqvxdFGSKyksE/pubhtml?gid=1987680909&single=true', true);
            request.setRequestHeader("Content-Type", "application/json");
            request.addEventListener("load", handler);
            request.send();
        }
    }

    function handler() {
        if(request.readyState === XMLHttpRequest.DONE && request.status === 200) {
            //console.log(format(request.responseText));
            document.querySelector('#googlSheet').innerHTML = format(request.responseText);
        }     
    }

    function format(html) {
        return html
            .replace(/href='\/static\//g, "href='https://docs.google.com/static/")
            .replace(/display:none;/g, '')
            .replace(/<span class="name">/g, '<span class="name" style="display:none;">')
            .replace(/<div id="footer">/g, '<div id="footer" style="display:none;">');
    }
    
    callGoogleSheet();
</script>